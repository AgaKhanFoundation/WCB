CREATE TABLE `achievement` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, `distance` INT NOT NULL, UNIQUE (name));
CREATE TABLE `team` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, UNIQUE (name));
CREATE TABLE `achievements` (`id` INT PRIMARY KEY AUTO_INCREMENT, `team_id` INT REFERENCES `team` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, `achievement_id` INT REFERENCES `achievement` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, UNIQUE (team_id, achievement_id));
CREATE TABLE `cause` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, UNIQUE (name));
CREATE TABLE `donor` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, `luminate_id` VARCHAR(255) NOT NULL UNIQUE, UNIQUE (name), UNIQUE (luminate_id));
CREATE TABLE `source` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, UNIQUE (name));
CREATE TABLE `locality` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, UNIQUE (name));
CREATE TABLE `event` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, `description` TEXT NOT NULL, `start_date` DATETIME NOT NULL, `end_date` DATETIME NOT NULL, `team_limit` INT NOT NULL, `team_building_start` DATETIME NOT NULL, `team_building_end` DATETIME NOT NULL, `locality_id` INT REFERENCES `locality` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `cause_id` INT REFERENCES `cause` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, UNIQUE (name));
CREATE TABLE `participant` (`id` INT PRIMARY KEY AUTO_INCREMENT, `fbid` VARCHAR(255) NOT NULL UNIQUE, `team_id` INT REFERENCES `team` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `source_id` INT REFERENCES `source` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `cause_id` INT REFERENCES `cause` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `event_id` INT REFERENCES `event` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, UNIQUE (fbid));
CREATE TABLE `donors` (`id` INT PRIMARY KEY AUTO_INCREMENT, `participant_id` INT REFERENCES `participant` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, `donor_id` INT REFERENCES `donor` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, UNIQUE (participant_id, donor_id));
CREATE TABLE `record` (`id` INT PRIMARY KEY AUTO_INCREMENT, `date` DATETIME NOT NULL, `distance` INT NOT NULL, `participant_id` INT REFERENCES `participant` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `source_id` INT REFERENCES `source` (`id`) ON DELETE SET NULL ON UPDATE CASCADE);
CREATE TABLE `sponsor` (`id` INT PRIMARY KEY AUTO_INCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, `luminate_id` VARCHAR(255) NOT NULL UNIQUE, UNIQUE (name), UNIQUE (luminate_id));
CREATE TABLE `sponsors` (`id` INT PRIMARY KEY AUTO_INCREMENT, `participant_id` INT REFERENCES `participant` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, `sponsor_id` INT REFERENCES `sponsor` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, UNIQUE (participant_id, sponsor_id));
